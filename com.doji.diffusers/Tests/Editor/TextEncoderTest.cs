using Doji.AI.Transformers;
using NUnit.Framework;
using System.Collections.Generic;
using System.IO;
using Unity.Sentis;
using UnityEngine;

namespace Doji.AI.Diffusers.Editor.Tests {

    /// <summary>
    /// Test the <see cref="Diffusers.TextEncoder"/> of a <see cref="StableDiffusionPipeline"/>.
    /// Requires the models for runwayml/stable-diffusion-v1-5 to be downloaded.
    /// </summary>
    public class TextEncoderTest : TestBase {

        /// <summary>
        /// the expected embedding for the prompt "a cat" with SD 1.5 defaults 
        /// </summary>
        private static readonly float[] expectedEmbedding = new float[] {
            -0.388377f, 0.022944f,  -0.052197f, -0.184061f, -0.027319f, -0.335549f, -0.017579f, -0.186929f,
            0.187707f,  -0.090662f, -0.228012f, -0.149698f, -0.074114f, -0.354687f, 0.113442f,  -0.101650f,
            -0.119779f, -0.100190f, 0.044720f,  -28.091179f, -0.140188f, -0.178678f, -0.084874f, -0.095002f,
            -0.089858f, -0.108752f, -0.183922f, -0.181636f, -0.311322f, -0.041487f, -0.009218f, -0.048338f,
            -0.114563f, -0.067551f, -0.214231f, -0.333727f, -0.373953f, -0.139659f, -0.053018f, 0.039688f,
            -0.155272f, -0.159991f, -0.162945f, -0.189938f, -0.163945f, -0.305622f, 0.037789f,  -0.153023f,
            -0.352628f, -0.143581f, -0.015924f, -0.096371f, -0.295489f, -0.109430f, -0.316112f, -0.313299f,
            0.001827f,  -0.146478f, -0.305339f, 0.083986f,  0.016643f,  -0.080154f, -0.183555f, -0.230231f,
            -0.247236f, -0.253703f, -0.363530f, -0.287369f, -0.165793f, 0.263023f,  -0.164429f, -0.172661f,
            -0.697995f, -0.347984f, -0.201740f, -0.181665f, -0.066955f, -0.074934f, 0.147100f,  -0.130605f,
            -0.143694f, -0.069908f, -0.143858f, -0.189447f, -0.056129f, -0.304488f, 0.191227f,  -0.114194f,
            -0.018167f, -0.164318f, -0.373766f, 0.000255f,  -0.054433f, -0.124427f, -0.265375f, -0.089642f,
            0.062727f,  -0.125972f, -0.213657f, 0.032530f,  -0.126464f, -0.419271f, -0.113008f, -0.408324f,
            -0.079264f, -0.184558f, 0.131187f,  0.024344f,  -0.147858f, -0.074249f, -0.000111f, -0.203306f,
            -0.189645f, -0.114728f, -0.036882f, -0.265844f, -0.001885f, -0.063345f, -0.229759f, -0.092081f,
            -0.013799f, 0.065170f,  -0.142446f, 0.024336f,  0.170750f,  -0.044127f, 0.024143f,  0.041507f,
            -0.295408f, 0.031601f,  0.004651f,  -0.230620f, -0.068843f, 0.063385f,  0.095262f,  -0.012201f,
            -0.223031f, -0.237806f, 0.074069f,  -0.112879f, -0.061130f, -0.028100f, -0.127541f, -0.190302f,
            -0.169828f, -0.112522f, 0.157205f,  -0.140288f, -0.262990f, -0.268721f, -0.187782f, -0.176320f,
            -0.217157f, -0.124260f, -0.004112f, 0.397810f,  -0.263950f, -0.242047f, -0.240822f, -0.168503f,
            -0.269182f, 0.046092f,  -0.235980f, -0.305534f, -0.060117f, 0.066852f,  -0.025582f, -0.030705f,
            -0.145947f, -0.305202f, 0.097042f,  -0.024385f, -0.169612f, -0.085111f, -0.167684f, -0.098846f,
            -0.207365f, -0.142866f, -0.046046f, 0.049689f,  -0.351496f, -0.048942f, -0.103142f, -0.028766f,
            -0.131971f, 0.129499f,  -0.270932f, -0.654990f, -0.031329f, 0.152354f,  -0.277983f, -0.313915f,
            -0.077344f, -0.099343f, -0.028424f, -0.081507f, 0.156291f,  -0.033450f, 0.358297f,  0.126311f,
            -0.018223f, -0.158842f, -0.178239f, -0.088465f, -0.126072f, -0.304719f, 0.039012f,  -0.071987f,
            -0.280276f, -0.294579f, 0.110677f,  -0.396645f, -0.248658f, -0.118920f, -0.292995f, -0.238170f,
            -0.195140f, -0.181321f, -0.238561f, 0.187406f,  0.104566f,  0.182205f,  0.033320f,  0.099166f,
            -0.073641f, 0.083867f,  -0.329968f, -0.177146f, -0.288785f, -0.035523f, -0.107633f, -0.285548f,
            -0.175800f, -0.258447f, -0.129930f, -0.432277f, 0.149411f,  -0.174100f, -0.383259f, -0.173729f,
            -0.035233f, -0.134270f, 0.005912f,  -0.156580f, -0.178112f, -0.153346f, -0.163551f, -0.166534f,
            -0.140294f, 0.049307f,  -0.009475f, -0.195726f, -0.203441f, -0.177145f, -0.274102f, -0.175854f,
            -0.026906f, -0.167238f, -0.309873f, -0.200581f, -0.253787f, -0.421529f, 0.184404f,  0.077154f,
            -0.246861f, -0.074649f, -0.143516f, -0.218516f, 0.128776f,  0.087133f,  0.042176f,  -0.020271f,
            -0.015068f, -0.011493f, 0.012533f,  -0.113551f, -0.059424f, -0.110287f, 0.115031f,  -0.119298f,
            -0.133909f, -0.151012f, -0.261285f, -0.060336f, -0.154977f, -0.113739f, -0.213782f, 0.169232f,
            -0.176340f, 0.169968f,  -0.244200f, -0.120340f, -0.083162f, -0.298175f, -0.075634f, -0.020089f,
            -0.083813f, -0.182493f, -0.222415f, -0.032090f, -0.248198f, 0.150425f,  -0.011423f, -0.390073f,
            0.019476f,  -0.125026f, -0.199995f, -0.206113f, -0.199094f, -0.116970f, -0.137431f, -0.367799f,
            0.002825f,  0.095982f,  -0.171472f, 0.029655f,  0.125925f,  -0.237467f, -0.291021f, -0.012797f,
            -0.214275f, -0.308823f, -0.134314f, 0.003928f,  -1.747257f, 0.110957f,  -0.271716f, -0.161107f,
            -0.137479f, -0.048951f, -0.398898f, -0.231234f, -0.332516f, -0.015119f, 0.006562f,  -0.010958f,
            -0.204254f, -0.008725f, 0.011434f,  0.029862f,  0.009210f,  -0.290799f, -0.117881f, 0.146407f,
            -0.221529f, 0.072619f,  -0.043188f, 0.024273f,  0.091478f,  0.231189f,  0.172992f,  -0.239948f,
            -0.234364f, -0.153711f, -0.165135f, -0.178081f, -0.364116f, -0.092025f, -0.018933f, -0.016935f,
            -0.096594f, -0.084620f, -0.054024f, -0.249002f, -0.148973f, -0.356080f, -0.202985f, -0.074194f,
            -0.248140f, -0.201526f, -0.230133f, -0.115971f, -0.065730f, -0.136466f, -0.312073f, -0.262565f,
            -0.006515f, -0.213723f, -0.006752f, 0.003439f,  -0.024690f, -0.264988f, -0.230802f, -0.093046f,
            0.109641f,  -0.229323f, -0.127274f, 0.078314f,  0.065971f,  -0.248475f, -0.184834f, -0.065422f,
            -0.043087f, -0.052973f, -0.255593f, 0.014048f,  -0.276654f, -0.138565f, -0.212762f, -0.383132f,
            -0.147801f, -0.049891f, -0.101421f, -0.115449f, -0.039003f, -0.200328f, -0.091701f, -0.039056f,
            -0.183220f, 0.096294f,  -0.258660f, -0.438692f, -0.138391f, 0.141934f,  -0.515209f, 2.930875f,
            -0.183247f, -0.250735f, 0.146582f,  -0.130580f, -0.137792f, -0.148142f, -0.023052f, -0.134940f,
            -0.108871f, -0.023968f, 0.195479f,  0.002930f,  -0.077372f, -0.238815f, -0.081108f, -0.071517f,
            0.095102f,  -0.245069f, -0.340887f, 0.268299f,  -0.115587f, -0.085491f, -0.370508f, -0.211594f,
            -0.082929f, -0.094251f, -0.040531f, 0.269326f,  -0.068021f, 0.046343f,  0.086327f,  -0.178495f,
            -0.016442f, -0.164470f, -0.037961f, -0.227005f, -0.229731f, -0.011341f, -0.175068f, -0.185644f,
            -0.332428f, -0.116159f, -0.092115f, -0.171143f, -0.221686f, -0.140221f, -0.276534f, -0.109180f,
            -0.249088f, -0.112838f, -0.058967f, 0.101066f,  -0.235217f, -0.291144f, 0.180029f,  -0.078808f,
            -0.214898f, -0.049890f, -0.067250f, -0.218872f, -0.364593f, -0.319397f, 0.116754f,  -0.311121f,
            -0.010251f, 0.075050f,  0.121637f,  -0.423336f, 0.062772f,  -0.136981f, -0.176604f, -0.143655f,
            -0.005584f, -0.200289f, -0.035962f, -0.060626f, -0.157255f, -0.007966f, -0.021151f, -0.239809f,
            -0.159798f, -0.301656f, -0.042054f, 0.008891f,  -0.071371f, -0.082929f, -0.262809f, -0.078955f,
            -0.234637f, -0.171595f, -0.140191f, 0.163819f,  -0.147249f, -0.138412f, -0.341180f, 0.097298f,
            -0.171070f, -0.138564f, -0.118991f, 0.027289f,  -0.150046f, -0.197089f, -0.162479f, 0.095083f,
            0.201011f,  0.071706f,  -0.334526f, -0.392976f, -0.256349f, -0.089411f, 0.059089f,  -0.326508f,
            0.069951f,  -0.035033f, -0.164077f, -0.451762f, -0.173844f, -0.125198f, -0.027342f, -0.236713f,
            0.000820f,  -0.135221f, 0.033039f,  -0.178058f, 0.092535f,  -0.111663f, -0.000929f, -0.079941f,
            -0.121395f, -0.084176f, -0.289676f, -0.138837f, -0.010586f, -0.340055f, -0.132559f, -0.098393f,
            -0.081015f, -0.133400f, -0.264466f, -0.080236f, 0.207519f,  -0.245447f, -0.405835f, -0.122427f,
            0.012535f,  -0.084216f, -0.131082f, -0.037627f, -0.112259f, -0.210338f, -0.170297f, 0.057464f,
            -0.182714f, -0.352562f, -0.078945f, -0.006330f, -0.277305f, -0.162769f, -0.169759f, -0.052237f,
            0.055228f,  -0.062156f, -0.079991f, 0.049854f,  -0.056445f, -0.301653f, -0.081092f, -0.300821f,
            -0.180753f, -0.440302f, -0.225171f, -0.040573f, -0.059003f, -0.337602f, -0.016021f, 0.084462f,
            -0.188788f, -0.059850f, -0.414433f, 0.040191f,  -0.125796f, -0.126637f, 0.056370f,  0.016973f,
            0.147987f,  0.009401f,  -0.155056f, -0.180806f, -0.118866f, 0.003290f,  -0.315112f, 0.224869f,
            -0.007180f, -0.058516f, -0.312304f, -0.039823f, -0.046228f, 0.133362f,  0.081319f,  -0.170431f,
            0.059600f,  0.027891f,  -0.397468f, -0.078170f, -0.139329f, -0.090666f, -0.018741f, -0.029102f,
            -0.156841f, 0.053318f,  -0.468373f, -0.129934f, -0.257566f, -0.151547f, -0.225183f, -0.232134f,
            -0.199241f, -0.257873f, 0.029806f,  -0.154010f, 0.091638f,  -0.057320f, -0.128761f, 0.053038f,
            -0.034641f, -0.161488f, -0.217196f, 0.054302f,  0.009247f,  0.152312f,  -0.081599f, -0.204301f,
            -0.195513f, -0.087982f, -0.200525f, 0.069447f,  0.049449f,  -0.364696f, 0.045894f,  -0.048042f,
            -0.021501f, 0.007675f,  -0.347027f, -0.190826f, 0.085830f,  -0.210201f, -0.067144f, -0.306819f,
            -0.113826f, -0.129899f, -0.090298f, -0.097270f, 0.024440f,  -0.220492f, 0.137035f,  -0.238838f,
            -0.220929f, -0.059701f, -0.062375f, -0.240627f, 0.071660f,  -0.154805f, -0.127555f, -0.050638f,
            -0.247551f, 33.063206f, -0.316306f, -0.288039f, 0.058366f,  0.031589f,  -0.018864f, 0.037612f,
            0.131296f,  -0.244445f, -0.242564f, -0.083870f, -0.091386f, -0.144889f, -0.119903f, 0.028148f,
            0.097470f,  -0.014662f, -0.381136f, 0.149303f,  -0.229931f, -0.237951f, 0.085664f,  -0.154480f,
            -0.059498f, -0.034737f, -0.584053f, -0.140651f, -0.083028f, -0.316956f, -0.238559f, -0.147885f,
            -0.207335f, -0.140292f, -0.088830f, -0.071659f, -0.117220f, -0.047280f, -0.217986f, -0.214745f,
            -0.055298f, -0.051975f, -0.026755f, -0.120567f, 0.109331f,  -0.035642f, 0.350419f,  -0.172735f,
            -0.085228f, -0.079807f, -0.253096f, -0.114980f, -0.157731f, -0.225276f, -0.046393f, 0.159058f,
            -0.182793f, -0.105474f, -0.228541f, -0.255061f, -0.202079f, -0.274175f, -0.074420f, -0.028786f,
            0.126048f,  -0.067411f, -0.181668f, -0.198007f, 0.052771f,  -0.083703f, 0.155026f,  -0.078751f,
            -0.230207f, -0.097031f, -0.127400f, -0.157151f, -0.132145f, -0.155446f, -0.204386f, -0.040000f,
            -0.427648f, -0.300965f, -0.245181f, 0.161179f,  0.100714f,  -0.489883f, -0.306602f,  0.067454f,
            0.029033f,  -1.325785f, 0.308456f,  -0.061469f, 0.039829f,  -0.710692f, -0.969259f, -0.486152f,
            -0.804271f, 0.523831f,  1.806862f,  -0.619999f, -0.000424f, -0.378035f, 0.448629f,  -0.251098f,
            -1.547808f, 1.485897f,  0.685405f,  3.856164f,  0.092752f,  0.182247f,  -1.597176f, 0.042246f,
            -0.653981f, -1.868316f, 1.481611f,  -0.501608f, -0.276433f, -2.495313f, -0.808399f, 1.212516f,
            -0.558222f, 0.162162f,  -0.359952f, 0.365726f,  -0.373586f, -0.848721f, 1.802538f,  -0.856734f,
            -0.146531f, 0.444406f,  -0.750722f, 0.055561f,  0.714667f,  1.845328f,  -0.476220f, -0.597575f,
            -0.904122f, -0.435512f, 0.221845f,  -1.141342f, -0.144785f, 0.584341f,  0.588351f,  1.484538f,
            0.411822f,  -0.466478f, -0.006027f, 0.455532f,  0.619958f,  -0.287668f, -1.444694f, 0.142675f,
            0.552352f,  0.270400f,  -0.668511f, 0.342876f,  -0.306361f, 5.655385f,  -1.347967f, -1.042588f,
            -0.679705f, -1.405473f, -0.103224f, 1.480989f,  -0.684949f, -0.656201f, 0.727007f,  -0.731555f,
            -0.451238f, 0.146842f,  -0.168811f, 0.789859f,  0.589659f,  -0.402976f, 0.624085f,  -1.182481f,
            -1.637713f, 0.555810f,  -0.318555f, -1.172518f, 0.982290f,  1.499001f,  1.158248f,  1.130578f,
            -1.055786f, -0.678495f, -0.059530f, 0.182272f,  -0.525550f, 0.810403f,  0.332963f,  -1.540595f,
            -0.921859f, -1.534145f, 0.232260f,  -0.479418f, 1.475351f,  -0.686080f, -0.563947f, -0.023934f,
            -0.419843f, -0.527913f, -1.011218f, -2.892538f, 0.724997f,  -0.066684f, 0.057204f,  0.644128f,
            -0.299727f, 0.510961f,  0.156343f,  0.236808f,  -0.118904f, 0.157160f,  -0.195854f, 0.426694f,
            -1.217293f, 0.655894f,  -0.995281f, 0.829700f,  -0.967238f, 0.055186f,  -1.763257f, -0.374840f,
            -0.650018f, 0.651797f,  0.617125f,  0.823831f,  0.190389f,  -0.569691f, -0.746895f, -0.545703f,
            0.153415f,  -0.572346f, -0.768949f, 1.176806f,  -0.862127f, -0.082801f, -1.300261f, 0.806987f,
            -0.925265f, -1.125504f, -0.544961f, 1.674216f,  0.151223f,  1.234100f,  -2.033470f, -0.690405f,
            -0.010340f, 0.187696f,  -0.244659f, -2.112337f, 1.304464f,  -1.860216f, -0.290261f, 0.820625f,
            -0.165488f, 0.953966f,  -1.158110f, -1.080712f, -0.676133f, -1.779312f, 0.181305f,  0.503513f,
            0.411109f,  0.970156f,  -0.200400f, 1.033816f,  -0.265175f, 1.008656f,  -0.480213f, 0.740109f,
            0.361684f,  0.153403f,  -0.463601f, -4.361883f, -0.712143f, 0.974845f,  -0.459822f, 0.042423f,
            0.528209f,  -0.979493f, -0.736405f, -0.253652f, 0.370307f,  -0.273978f, -6.426798f, -1.007585f,
            0.634696f,  -1.873509f, 0.945067f,  -1.032141f, -0.586361f, -0.298374f, -1.185049f, -0.361785f,
            1.385107f,  1.090129f,  -0.128290f, -0.879264f, 1.240991f,  -1.577548f, -0.970226f, 1.083350f,
            0.669879f,  -0.470882f, -0.871254f, -0.415309f, -0.468027f, 0.034108f,  0.860521f,  -0.358596f,
            0.352538f,  -0.434196f, 0.007698f,  0.316025f,  -0.484246f, -1.668438f, 0.544647f,  0.356096f,
            -0.257669f, -0.255479f, 0.187704f,  0.748355f,  -1.071209f, -0.460904f, -1.023835f, -0.535444f,
            -0.287234f, -0.203594f, -0.431896f, -0.980793f, -0.703269f, -0.590910f, 0.766423f,  -2.060391f,
            -0.547993f, -1.015840f, 0.726977f,  0.014110f,  -0.011882f, 0.594210f,  -0.462760f, -0.022373f,
            -1.190337f, 0.981437f,  0.985208f,  0.350167f,  -1.204340f, -0.113069f, 2.176347f,  -0.758316f,
            0.255514f,  -0.545467f, 0.338538f,  -1.056314f, -0.510023f, -0.009225f, 1.750714f,  -0.821831f,
            1.102811f,  -0.655803f, 0.775680f,  0.516176f,  -0.673610f, 0.114846f,  -0.045206f, 0.897264f,
            -0.462179f, 3.483610f,  -0.050731f, -0.279198f, 1.256717f,  -0.660021f, 1.399807f,  0.005792f,
            -0.797710f, 0.876451f,  -0.472591f, 0.613954f,  -0.104397f, -0.228962f, -0.021232f, -0.283490f,
            -1.642498f, 0.124370f,  -0.556358f, -1.256526f, -0.116236f, 0.150269f,  0.438869f,  1.278413f,
            -0.298853f, -0.871412f, -0.272534f, -0.829671f, 2.858829f,  -1.514214f, -1.543878f, -0.992699f,
            -0.551595f, -0.743775f, -0.754885f, -0.802206f, 0.035437f,  -0.112454f, -0.831057f, 0.624124f,
            0.976215f,  0.263519f,  0.382623f,  -1.058392f, -1.501103f, 0.222059f,  0.104411f,  -1.006180f,
            0.531247f,  -0.202073f, 0.279422f,  0.819462f,  -0.587481f, 0.458286f,  0.844584f,  0.662451f,
            2.384096f,  0.628785f,  0.317799f,  -0.963806f, 0.269123f,  2.229638f,  -0.406137f, -0.184569f,
            0.838856f,  0.710067f,  0.945980f,  -0.484540f, 0.321601f,  -1.356527f, -1.110950f, 0.066063f,
            -1.114541f, -4.091300f, -1.920283f, -0.298084f, 0.509098f,  -0.443919f, 0.740052f,  -1.469783f,
            1.345231f,  0.425423f,  -1.078208f, -0.299950f, 0.709539f,  -0.150050f, -1.669484f, 0.269392f,
            0.240660f,  0.460194f,  0.881542f,  0.640075f,  0.424707f,  -0.468307f, 0.554007f,  -0.801633f,
            0.269227f,  -0.932928f, -0.817849f, 0.367960f,  0.522442f,  0.897198f,  -0.023946f, -0.573532f,
            0.544304f,  -1.098594f, 0.585901f,  -1.515683f, -0.698904f, 0.295302f,  -0.063863f, 1.304229f,
            0.703248f,  -1.177951f, -0.323069f, -0.637529f, -1.277423f, -1.441436f, 0.043826f,  0.531456f,
            0.400688f,  -1.359940f, 0.098184f,  -1.310646f, -1.210463f, -1.061560f, 0.299681f,  1.482565f,
            -0.864749f, -0.163751f, -0.326298f, 1.573675f,  -0.495746f, -0.463066f, -1.990980f, -7.740601f,
            -0.458907f, 0.591923f,  -0.569728f, -2.183680f, 0.674197f,  1.181302f,  -1.334634f, -1.753503f,
            0.176961f,  0.169089f,  -0.540699f, -0.604940f, 0.533634f,  -0.060393f, 0.105009f,  -1.100022f,
            1.030968f,  0.250442f,  -0.049665f, -0.018653f, 0.074307f,  -0.447799f, 0.431148f,  0.677933f,
            0.737880f,  -0.113987f, 0.567930f,  0.497596f,  0.479112f,  -0.553393f, -1.224248f, -1.121744f,
            1.213317f,  -0.647741f, 0.688830f,  1.738298f,  -0.352583f, 0.568961f,  -0.387658f, 0.021826f,
            0.276731f,  -0.548948f, -1.747649f, -0.760308f, -0.264496f, 0.109714f,  -0.189040f, 0.547184f,
            -0.633444f, 0.638824f,  -0.304574f, 0.421181f,  -0.187416f, -0.914695f, 0.904296f,  0.694022f,
            0.152309f,  -0.554861f, -0.726152f, -1.539407f, 0.464419f,  0.121037f,  0.693796f,  1.481561f,
            -0.629374f, -0.700523f, 0.097338f,  0.104198f,  1.541774f,  -1.041742f, 0.743327f,  1.349068f,
            0.208457f,  -0.036083f, -0.895591f, -0.646234f, 0.088254f,  0.030070f,  0.175526f,  0.404687f,
            -0.339415f, -0.332270f, -0.220061f, -0.857267f, -0.068421f, 0.805172f,  -0.702420f, -0.668617f,
            -0.670777f, -0.570437f, -1.391380f, 0.958312f,  1.084955f,  0.022802f,  -1.078595f, 0.076611f,
            -0.210291f, 0.093063f,  0.587387f,  -1.085654f, 0.661798f,  0.671705f,  -1.774444f, -2.011996f,
            -0.055735f, -1.629636f, 0.440908f,  -0.293764f, 1.675737f,  -0.315594f, -0.311364f, -0.476604f,
            1.628843f,  -0.763418f, 0.194597f,  -0.156650f, 1.030299f,  -0.953167f, -1.674741f, 1.909985f,
            -1.260569f, 0.807046f,  0.351202f,  0.901920f,  -0.619890f, -0.464625f, 0.757395f,  -0.785367f,
            0.116985f,  -1.087728f, -0.551981f, 1.473792f,  -1.032488f, -0.401161f, 0.391504f,  -0.347963f,
            0.700697f,  -0.157623f, -0.479594f, 0.161759f,  0.922427f,  0.364900f,  0.397160f,  0.487121f,
            0.605716f,  2.922639f,  -0.189300f, -0.850828f, -0.153639f, 0.599882f,  -1.289816f, 0.503974f,
            -0.824059f, 1.598961f,  -0.275764f, 0.352640f,  0.802485f,  0.724528f,  1.555133f,  -1.313407f,
            -0.717944f, -0.753513f, -0.338927f, 0.719371f,  1.834315f,  0.016387f,  -0.467765f, -0.322873f,
            0.417079f,  -0.897216f, 2.473367f,  0.879672f,  -1.684114f, -0.187080f, 0.959350f,  -0.046188f,
            -1.617047f, 0.741117f,  1.119702f,  0.309114f,  -0.521300f, 0.623152f,  0.374479f,  -0.237823f,
            -1.359834f, 0.901719f,  0.314190f,  -0.242374f, -0.411726f, -0.304280f, -0.913088f, -1.395380f,
            0.135128f,  -0.058618f, -0.930028f, -0.435469f, 0.261223f,  -0.473504f, -0.410628f, 0.260683f,
            1.413359f,  0.311391f,  0.123132f,  1.500202f,  0.963154f,  -0.747747f, -0.244890f, -2.155359f,
            1.924396f,  -1.196881f, 0.724621f,  1.471275f,  0.060930f,  -0.067633f, -0.557395f, 0.009634f,
            -0.711320f, -0.480962f, -2.074136f, 1.114328f,  -1.015781f, -0.119307f, -0.157388f, 1.681447f,
            -0.094002f, 0.123325f,  0.422949f,  -0.128048f, 3.421638f,  -0.558397f, -1.063490f, -1.714028f,
            -0.934098f, 1.026772f,  -0.380195f, 0.949271f,  -0.895758f, -0.534570f, -0.012650f, 0.260757f,
            -1.047094f, -1.038391f, 1.273889f,  -0.457800f, -0.096853f, -0.345849f, -0.292740f, 1.041549f,
            0.952548f,  0.274109f,  0.624220f,  -0.171412f, -0.283078f, -0.276510f, 0.124638f,  -0.485872f,
            -0.044288f, -0.945151f, 0.419704f,  0.128823f,  0.437800f,  -1.621770f, 0.480733f,  -0.028140f,
            -0.541878f, -3.970054f, -0.459906f, 1.084106f,  1.166717f,  -0.824353f, -0.678867f, 0.125110f,
            0.628167f,  -0.212286f, 0.218267f,  -0.777082f, 0.647188f,  -0.005118f, -0.606887f, -1.049812f,
            2.233217f,  -1.885090f, -0.879280f, -0.252461f, -0.289950f, 0.437372f,  0.538030f,  1.218730f,
            0.218105f,  -0.602762f, -0.222663f, -0.237836f, 0.572675f,  0.609531f,  0.479330f,  0.020606f,
            -0.046687f, -0.111462f, 0.453429f,  -0.354915f, -0.076070f, -0.191774f, -1.726687f, 0.336694f,
            0.115937f,  0.715030f,  0.966795f,  0.446091f,  0.481333f,  -0.899611f, -3.527507f, -1.474536f,
            -0.897664f, -1.375842f, 0.597838f,  -0.554969f, 0.100180f,  -0.268625f, -1.551297f, 0.898790f,
            0.295550f,  0.651708f,  0.613295f,  -0.178994f, 0.320150f,  -0.764619f, -1.037845f, 0.368218f,
            1.507163f,  0.003612f,  -0.623225f, -2.900529f, -1.644621f, 0.251502f,  -0.325204f, -0.681879f,
            -0.623487f, -0.579067f, -1.857898f, -0.382079f, -0.581020f, -0.453774f, 0.330979f,  -0.592113f,
            0.359985f,  0.468271f,  1.304833f,  1.338711f,  -0.719560f, -0.525679f, 0.976810f, 0.665174f,
        0.117698f,  0.911226f,  0.636023f,  -0.331469f, 0.802402f,  0.228679f,  -0.968025f, -0.915174f,
            0.532549f,  -0.586307f, 0.204031f,  -0.096046f, -1.352992f, -0.125432f, -0.721162f, -0.891419f,
            -1.995733f, -0.593985f, 2.307456f,  -8.212749f, -0.421795f, 1.092847f,  -2.139091f, 0.401127f,
            -1.242747f, -1.793844f, -0.264887f, -0.306936f, 1.249128f,  -1.552191f, 1.007433f,  0.815807f,
            1.550840f,  -2.350501f, -0.100061f, -0.842660f, 0.143052f,  0.096819f,  -0.477088f, 0.966639f,
            -0.377980f, 0.691068f,  -0.390313f, -0.013587f, -1.416608f, 0.113879f,  0.417381f,  -0.175591f,
            -1.049215f, -0.878865f, 1.173035f,  0.249468f,  0.564648f,  0.549035f,  -0.100897f, 0.230629f,
            1.017045f,  -0.009356f, 0.192369f,  0.349703f,  -0.141765f, -1.585477f, -0.234203f, 0.129204f,
            0.431040f,  -0.370213f, 0.048184f,  -0.041396f, -1.049801f, 3.519560f,  -1.316498f, 0.563534f,
            -1.151268f, -1.470821f, -1.066987f, 0.246228f,  1.272553f,  0.317567f,  0.231441f,  -1.696703f,
            -0.991386f, 0.243096f,  0.156595f,  0.297580f,  -0.836566f, -1.055292f, -0.324042f, -0.722369f,
            -2.976636f, -0.339684f, 0.453855f,  -1.518105f, 0.393761f,  -0.121647f, 0.612030f,  1.170108f,
            -1.421611f, 0.728714f,  -0.700792f, 1.304671f,  0.259430f,  0.153577f,  -0.879640f, 0.268000f,
            0.049869f,  -1.668442f, -1.761434f, 0.523784f,  -0.732450f, -0.094304f, -1.707074f, 0.438713f,
            -0.498039f, -0.821082f, -0.456010f, -1.773665f, 1.393543f,  0.190762f,  -0.281391f, -0.661247f,
            0.447550f,  1.365836f,  0.065780f,  -0.545103f, -1.160257f, 1.912371f,  -0.657459f, -0.155270f,
            -1.640239f, -0.353341f, -0.479154f, -1.212797f, -0.006236f, 0.290143f,  0.839783f,  -0.682308f,
            0.266079f,  -1.046556f, 0.044008f,  0.073606f,  -1.720844f, -0.888785f, -0.057721f, -0.613895f,
            -0.217035f, 0.662634f,  -1.839138f, -0.997770f, 0.197007f,  0.626006f,  0.173023f,  0.169242f,
            1.575702f,  -0.604228f, -0.261898f, -1.536597f, -0.754509f, -0.467819f, -0.657460f, -1.057639f,
            1.349352f,  -0.523090f, -0.543406f, -0.857457f, 2.310129f,  -0.425041f, 1.403008f,  -1.837664f,
            -0.502659f, 1.904940f,  0.347126f,  -1.700276f, -0.037993f, -0.885838f, 0.501823f,  1.858211f,
            -0.686735f, 1.162392f,  3.030481f,  -0.536949f, 0.463332f,  -1.868249f, 0.100623f,  0.519757f,
            -1.156358f, -0.548853f, -1.641281f, 5.539981f,  -0.951776f, -0.277734f, 1.118896f,  -0.847535f,
            -0.856542f, -1.214779f, 0.308115f,  -0.046187f, 1.072121f,  -0.563530f, -3.199046f, 0.312401f,
            -0.212972f, -0.798160f, 0.678186f,  -1.715418f, 0.276038f,  1.553187f,  0.138736f,  -1.412313f,
            -0.931795f, -0.304289f, 1.817841f,  0.593571f,  -0.545788f, -0.555422f, -0.585702f, 0.538075f,
            0.928574f,  0.540692f,  -0.091411f, 0.146259f,  -0.426122f, 0.023055f,  1.023043f,  1.065895f,
            1.123452f,  0.782876f,  0.073806f,  1.127131f,  -0.894193f, -1.868797f, -0.996517f, 0.261234f,
            -1.087668f, -1.101372f, -0.138042f, -0.068004f, 0.272579f,  -0.127881f, -0.316009f, -0.700137f,
            -1.618653f, -1.308000f, -0.648824f, -0.163787f, -2.214527f, -1.240600f, 0.365067f,  0.721309f,
            0.540697f,  -1.993265f, 0.242479f,  2.276604f,  0.027229f,  -0.821114f, -0.498467f, -1.025094f,
            -0.598814f, 0.584930f,  -0.792418f, 0.308858f,  0.427489f,  -0.435178f, -0.531211f, 0.936053f,
            -0.659676f, 1.223252f,  0.489393f,  -1.133471f, 0.129877f,  1.876629f,  -0.037792f, -1.417731f,
            -0.739270f, 1.281272f,  0.587309f,  -0.497316f, -0.168126f, 0.014436f,  0.183425f,  -0.452231f,
            -1.049784f, 0.330724f,  -0.383638f, 0.388156f,  0.148151f,  0.375548f,  -0.243717f, 1.818141f,
            -0.325428f, 0.876371f,  -1.050873f, 0.485767f,  0.208768f,  0.965884f,  -1.326914f, 0.249202f,
            -1.523954f, -0.383736f, 0.190401f,  0.727385f,  2.030300f,  0.553012f,  0.752184f,  0.142492f,
            -0.899031f, -1.651385f, -0.952315f, -0.344496f, 1.527527f,  -1.950672f, -0.993825f, -0.672962f,
            1.287415f,  -0.216415f, -0.271873f, -0.416680f, 0.016610f,  1.099935f,  0.082243f,  -0.369198f,
            0.335448f,  -0.455615f, 0.246306f,  0.813635f,  -1.657654f, -0.111007f, -0.044547f, -0.324669f,
            -2.499928f, 0.965998f,  0.568892f,  1.017344f,  1.165981f,  -0.151929f, 2.287162f,  1.536973f,
            0.086241f,  -0.802919f, 0.015127f,  -0.138114f, -1.370556f, 0.248717f,  0.243700f,  1.211625f,
            0.564082f,  -0.384008f, 1.510466f,  -0.633317f, 0.711710f,  -1.116504f, 1.125545f,  -1.571135f,
            -0.343960f, -0.300813f, -2.069032f, 0.587215f,  0.383859f,  -0.115019f, 2.073911f,  1.241160f,
            -0.776336f, 0.899554f,  -1.955004f, -0.550012f, 0.873337f,  -0.471849f, 0.129696f,  -1.198736f,
            0.912134f,  -0.100244f, 0.654041f,  -0.179458f, -0.750544f, 0.418680f,  -0.216702f, 0.380858f,
            -1.136037f, -1.108038f, 0.201213f,  1.892960f,  -0.776918f, 1.237583f,  0.570592f,  -1.114480f,
            1.514002f,  0.482355f,  -0.436777f, 0.065949f,  0.034927f,  -0.790429f, 1.074207f,  1.771362f,
            0.554896f,  0.463415f,  -1.092201f, 0.028340f,  -0.914376f, 0.359836f,  -1.036991f, -0.099360f,
            -0.037377f, -0.438277f, 0.363318f,  -0.061110f, 0.721222f,  -0.547874f, -0.747092f, -0.036570f,
            0.960931f,  -1.487100f, 0.706538f,  0.554608f,  0.619791f,  -0.270685f, -1.389615f, -1.320611f,
            -0.353114f, 1.600475f,  -0.343923f, -2.118859f, 0.123311f,  0.517218f,  -1.007294f, -1.928118f,
            0.743838f,  0.486037f,  -0.688436f, -0.101358f, 1.258249f,  -0.797339f, 0.084053f,  0.492625f,
            -0.607378f, 0.298647f,  -0.402426f, 1.273955f,  0.649966f,  -0.306247f, -0.635771f, -0.865656f,
            1.483382f,  -1.099200f, -0.007139f, 2.100381f,  0.057869f,  -0.072465f, -1.517429f, -0.652729f,
            -0.125774f, -2.131686f, -0.416272f, 0.746260f,  -2.722399f, -1.108298f, 0.250004f,  -0.601395f,
            0.476853f,  -1.156572f, -0.104677f, -1.357309f, 1.075614f,  -0.249249f, 1.102384f,  0.117736f,
            -0.367945f, -1.226843f, -0.319674f, 0.656668f,  -1.032247f, -1.058585f, -0.063864f, 1.415632f,
            -0.780315f, 0.370926f,  -1.889283f, 0.686594f,  0.228950f,  0.629663f,  0.434329f,  -0.587258f,
            1.074214f,  -0.766291f, 1.304749f,  -2.354205f, -1.494288f, 1.299026f,  -0.296722f, -0.327953f,
            0.703692f,  0.383961f,  0.440861f,  1.533384f,  0.532964f,  1.472143f,  0.205388f,  -0.368477f,
            0.460485f,  -1.122248f, -1.883560f, 1.436754f,  0.439262f,  1.014370f,  0.322223f,  0.209779f,
            -0.285367f, -1.364730f, -0.079480f, 0.371611f,  -1.474258f, -0.310732f, 0.785215f,  0.321563f,
            0.959405f,  -1.776370f, -1.081899f, -1.696598f, -0.649894f, -0.107988f, 0.318736f,  -1.092026f,
            -1.176827f, -0.355364f, -1.372380f, -0.290152f, -1.252557f, -0.770559f, -1.814153f, -2.784661f,
            -0.659398f, 0.648838f,  -1.171983f, -1.042866f, 0.116276f,  -0.778687f, -0.715079f, 0.634260f,
            0.146717f,  -0.711650f, 1.055257f,  -0.394757f, -1.063376f, -0.293652f, -0.704535f, -0.065648f,
            1.537477f,  -0.828423f, -0.565567f, 1.644374f,  -0.764829f, -1.468026f, 1.137028f,  0.096516f,
            -1.553552f, -1.110256f, 0.263219f,  0.048807f,  -0.245834f, -0.050929f, 0.088836f,  -0.306177f,
            -0.743316f, 1.074022f,  -1.475306f, 0.710179f,  0.503165f,  -1.123960f, -0.522734f, -0.676037f,
            1.147380f,  0.322741f,  -0.313062f, -1.264285f, 0.298491f,  1.074285f,  -0.167539f, -0.668324f,
            -0.942050f, -0.070072f, -0.583649f, 1.033983f,  -0.057356f, 0.066487f,  1.453297f,  -0.835189f,
            -0.498654f, -0.873400f, 1.401966f,  0.390587f,  -0.164469f, -0.114241f, -1.770222f, 0.300050f,
            1.293988f,  0.742728f,  -0.474895f, 1.586303f,  -0.290584f, -0.424197f, -0.884043f, 0.551402f,
            -0.868764f, -0.147222f, -0.235299f, 0.973068f,  -0.367469f, -0.455264f, -0.642922f, -1.490832f,
            0.820084f,  0.565735f,  -0.364817f, 0.520903f,  -0.449851f, -0.288671f, 0.914041f,  -0.665023f,
            1.452488f,  1.001318f,  -1.025132f, 1.087927f,  0.791214f,  -1.721265f, -0.541347f, -1.688680f,
            0.165324f,  -1.398370f, -1.082690f, 0.218443f,  -0.249543f, -0.646601f, 0.503041f,  -1.251105f,
            -0.711989f, -1.134664f, 1.100732f,  -1.001354f, -0.197667f, 0.266322f,  -0.056161f, -0.034553f,
            0.178767f,  1.073622f,  0.203588f,  -0.409964f, 2.034297f,  2.194274f,  0.280978f,  -1.735281f,
            1.201583f,  2.948409f,  1.475873f,  0.078591f,  -0.907900f, -0.939430f, -1.675791f, 0.336738f,
            -0.886662f, 0.034214f,  -0.914456f, 1.057225f,  0.592675f,  -1.433544f, -0.319262f, 0.114718f,
            0.711571f,  -0.743786f, 1.222047f,  -0.958748f, 0.396300f,  0.247517f,  1.063699f,  -0.402221f,
            -0.668833f, -1.138392f, -0.588362f, -1.408055f, 0.267440f,  -0.533105f, 1.190057f,  -0.006625f,
            0.604106f,  5.630178f,  -0.337668f, 0.345738f,  -0.849612f, -0.661708f, 0.914557f,  0.379731f,
            2.149724f,  -1.042378f, 0.556550f,  -0.205993f, 0.074846f,  -0.825200f, 0.555910f,  -0.157640f,
            0.983689f,  -0.827055f, 0.038630f,  -0.314178f, -0.536984f, 0.381848f,  -1.005760f, -0.715124f,
            -0.696715f, -1.605395f, -0.808338f, 1.337104f,  2.326977f,  -0.022536f, -0.364373f, 0.612995f,
            -0.356045f, -0.307341f, 1.064794f,  -0.902008f, 0.253841f,  -0.113237f, -0.253059f, 0.175880f,
            0.090451f,  -0.375347f, 0.527713f,  0.732978f,  -0.500130f, 0.837247f,  -0.343950f, -1.733585f,
            -0.510037f, 0.250576f,  -0.981763f, -0.825635f, -0.721715f, 0.145280f,  0.071597f,  0.343367f,
            0.145733f,  0.901165f,  0.795070f,  1.447466f,  0.238245f,  0.436321f,  0.859440f,  0.201255f,
            0.593227f,  0.010810f,  -1.314667f, -2.000383f, -1.038991f, 1.300045f,  0.772242f,  0.982743f,
            -0.200771f, -0.180883f, -0.904532f, 0.571663f,  -0.126344f, 1.534708f,  -0.257430f, 0.010069f,
            -1.222362f, 0.510459f,  0.331080f,  -0.344313f, -1.044917f, -3.096329f, 0.056212f, -0.065913f,
        -0.537506f, 0.231725f,  0.194676f,  0.693838f,  -1.328835f, 0.336156f,  -1.101268f, -1.344799f,
            0.678593f,  0.092646f,  -0.573696f, -0.797850f, -0.060316f, -1.160546f, 0.266345f,  0.617853f,
            -1.648778f, -0.139720f, 1.845530f,  2.163486f,  -0.166103f, 1.750304f,  -0.959437f, 1.470301f,
            -0.155001f, -0.877817f, -0.702712f, -1.857530f, 1.505378f,  -0.960726f, 0.400506f,  0.394160f,
            0.358961f,  -0.728761f, -0.037315f, 0.093526f,  -1.053163f, -1.350575f, -1.085209f, 0.300538f,
            0.518243f,  -0.763128f, 0.449585f,  -0.620515f, -0.466220f, -0.562528f, -0.094776f, -0.606124f,
            0.760112f,  -0.139219f, 1.999916f,  -0.388174f, -0.356371f, 0.875715f,  -0.130874f, -0.193892f,
            0.983597f,  -0.574122f, -0.105766f, -0.039096f, -0.393559f, -0.530082f, -0.634471f, -0.618983f,
            0.114399f,  -0.074247f, -0.115762f, 0.351124f,  -1.170058f, 5.236028f,  -1.208427f, 0.233712f,
            -1.338352f, -0.557039f, -2.306525f, -0.001740f, 0.230865f,  0.784398f,  0.766864f,  -1.351312f,
            -1.589568f, 0.336713f,  -0.339810f, 0.144247f,  -0.719050f, -1.350574f, -0.144377f, -0.329783f,
            -1.970043f, -0.443685f, -0.685571f, -1.573573f, 0.915770f,  -0.154849f, 0.286167f,  -0.720873f,
            -1.612189f, 1.245120f,  0.734707f,  -0.127527f, -1.204935f, -0.013248f, -0.519231f, 0.529855f,
            -1.527057f, -1.951992f, -1.159085f, -0.243797f, -1.218039f, 0.268356f,  -1.707948f, -0.196120f,
            -0.068707f, 0.439950f,  -1.424771f, -0.338858f, 0.853030f,  0.763485f,  0.716928f,  -0.182550f,
            1.528914f,  0.911934f,  -0.173997f, -0.767573f, -0.160816f, 0.782555f,  -1.374378f, -0.234316f,
            -0.783159f, -0.009364f, -0.602321f, -0.968004f, -0.329948f, -0.015991f, 1.252940f,  0.096980f,
            0.118624f,  -1.691219f, -0.129994f, 0.784193f,  -1.656631f, -0.960502f, -0.790060f, -1.099321f,
            -1.236376f, 0.327245f,  0.532740f,  -0.079856f, 1.055939f,  -0.318169f, -0.618411f, -0.365631f,
            0.820022f,  0.161565f,  -0.536049f, 6.636322f,  -0.688731f, -0.067974f, -1.658340f, -0.482740f,
            -1.221273f, -1.094011f, 0.371792f,  0.636805f,  0.701454f,  -1.185267f, -0.707461f, -1.852804f,
            -0.722157f, 0.537133f,  -1.142331f, -2.003586f, 0.379395f,  -1.647192f, -1.596800f, 1.471041f,
            -0.157723f, 1.804533f,  0.576645f,  -0.051188f, 0.783518f,  -0.610104f, -1.018098f, 0.683276f,
            0.023658f,  0.900077f,  -0.841208f, -0.780029f, -0.087797f, 0.322016f,  1.433958f,  -0.750435f,
            -0.526820f, -1.331909f, -0.418951f, -0.584151f, 0.230962f,  -0.610785f, -4.019300f, 0.708689f,
            0.178735f,  -1.327551f, 0.574430f,  -0.186982f, 1.030611f,  -0.028146f, 0.333015f,  -1.103867f,
            -1.663848f, 0.072505f,  -0.458972f, -0.259110f, -0.476402f, -0.878087f, -0.244761f, -0.158085f,
            0.326223f,  1.063759f,  -0.029399f, 1.490386f,  0.163938f,  -0.021804f, -1.393713f, 0.686481f,
            1.429825f,  0.746971f,  -1.163050f, 1.015617f,  0.165233f,  -1.510009f, -0.956815f, -1.332506f,
            -1.359155f, 0.056957f,  -0.385592f, 0.991989f,  -0.457147f, -0.153051f, -1.453010f, 0.019881f,
            0.250589f,  0.229880f,  -1.447452f, 0.896579f,  -2.610116f, -1.142081f, 0.248128f,  -0.155979f,
            0.225425f,  -0.837717f, 0.285809f,  0.799244f,  0.037336f,  -0.034970f, -0.152498f, -0.825371f,
            -0.742565f, 0.126353f,  -0.173251f, -0.113657f, 0.352710f,  -1.560499f, -0.261995f, 0.917200f,
            -0.842346f, 1.038957f,  -0.302932f, -1.151598f, -0.575414f, 1.623656f,  0.162129f,  -0.650541f,
            0.606078f,  0.885169f,  0.674382f,  -0.057785f, 0.309056f,  -1.095529f, -0.265342f, -0.648605f,
            -0.035147f, -1.901142f, -0.944453f, -0.956223f, -0.136651f, -0.629000f, 1.058858f,  1.688630f,
            -0.829886f, 0.891376f,  -0.299881f, -0.072335f, 0.030805f,  0.205062f,  -1.089900f, -0.089180f,
            -1.131978f, -0.475767f, -0.484607f, 0.016916f,  1.377885f,  -0.373950f, 0.349954f,  1.211019f,
            1.203541f,  -1.316414f, -0.973814f, -0.010198f, -0.072270f, -0.754614f, -1.385982f, -0.425667f,
            -0.145673f, -0.498441f, -1.452574f, -0.388035f, -0.187660f, 0.628480f,  -0.417450f, -0.044668f,
            -0.066024f, 0.380320f,  -0.377365f, 1.139895f,  6.421054f,  0.180496f,  -0.112228f, -0.742136f,
            -0.937254f, 0.293908f,  0.691923f,  -0.162912f, -0.280072f, 0.133203f,  -0.043569f, 0.926922f,
            1.007168f,  -1.592637f, 0.770269f,  -0.642793f, -0.070597f, 0.522624f,  0.478497f,  0.080356f,
            1.081624f,  0.005038f,  0.022911f,  -0.842414f, 1.017008f,  0.637974f,  0.049994f,  -1.579293f,
            0.035270f,  -1.063161f, -1.460120f, 1.979908f,  -0.008292f, -0.614886f, 0.293297f,  1.612284f,
            -0.414662f, 0.945240f,  -1.771368f, -0.460029f, -0.216256f, 0.613375f,  -0.823653f, -0.562451f,
            0.266400f,  0.659875f,  0.824714f,  0.672204f,  -0.384985f, 0.914545f,  0.037724f,  -1.117821f,
            -0.881917f, -0.299884f, 0.284059f,  0.611242f,  0.669723f,  0.809160f,  -0.187131f, -0.658247f,
            1.006669f,  -0.525813f, -2.227326f, 0.480480f,  -0.899115f, -0.600486f, 0.335401f,  0.721398f,
            -0.206561f, 0.141410f,  -1.766891f, -0.601490f, -0.023776f, 0.057816f,  0.642796f,  0.737556f,
            -0.489677f, -1.030307f, -0.078589f, -0.461396f, -0.732976f, -0.228075f, -0.276508f, 0.959191f,
            0.316752f,  -1.297510f, -0.808726f, 0.449008f,  -0.323099f, -0.613362f, -4.053105f, -0.960666f,
            -0.397543f, 0.255493f,  -1.058234f, -1.585617f, 0.800900f,  0.427226f,  -0.729451f, -1.550284f,
            0.579916f,  0.010977f,  1.514281f,  0.168387f,  1.183738f,  0.693811f,  0.013618f,  0.769005f,
            -0.371789f, -2.172538f, -1.058481f, 1.283144f,  -0.085405f, 0.213264f,  -0.701103f, 0.702001f,
            1.539918f,  -0.650922f, 0.196882f,  3.513618f,  0.457384f,  -0.266523f, -0.410795f, -0.210024f,
            -0.010316f, -1.292557f, 0.536860f,  1.229279f,  -1.972690f, -0.568312f, -0.403308f, -1.119139f,
            0.891780f,  -1.100349f, 1.245170f,  -0.780764f, 1.327092f,  -0.296444f, 0.794368f,  -0.965437f,
            -1.621700f, 0.692808f,  1.065427f,  0.567695f,  -0.279913f, -1.066546f, -1.111376f, 2.228628f,
            -1.054652f, 0.053899f,  -1.242513f, -0.270189f, 1.067863f,  0.058476f,  0.357389f,  0.325248f,
            0.186851f,  0.246282f,  0.288913f,  -3.926202f, 0.673830f,  0.014660f,  -0.453322f, 0.229315f,
            0.108160f,  0.316258f,  -0.709081f, 0.246732f,  0.904018f,  -0.623098f, 1.817297f,  -0.971122f,
            0.197074f,  -0.595102f, -0.980810f, 1.215141f,  -0.675973f, 0.219598f,  -0.242853f, 0.509233f,
            -0.848783f, 0.510450f,  -0.270773f, 0.326037f,  -0.992875f, -1.217534f, 0.363715f,  0.570819f,
            -0.969441f, -0.212722f, 0.018983f,  -0.929478f, -0.300909f, -1.148040f, -1.547517f, -0.097398f,
            0.550318f,  -1.040137f, -0.383711f, 1.014643f,  -1.287156f, -1.329401f, -1.643429f, -0.782315f,
            0.010009f,  0.457077f,  -0.676500f, -0.821947f, -0.763990f, -0.149622f, -0.922948f, -1.362365f,
            -0.122642f, -0.551743f, 0.530880f,  -0.074297f, -0.783793f, 1.066167f,  -1.135620f, -0.548732f,
            0.471318f,  0.648813f,  -0.380551f, 0.879827f,  -0.712013f, -0.559569f, 0.989690f,  -0.153619f,
            -1.963132f, -0.672558f, 0.307977f,  1.047563f,  0.013332f,  0.897247f,  0.101535f,  -0.325681f,
            0.250953f,  -3.837978f, -1.763398f, -0.925269f, 0.509930f,  0.134857f,  0.167462f,  -1.336659f,
            0.373004f,  -0.158479f, 0.667364f,  0.550001f,  0.421026f,  0.092605f,  -0.084989f, 0.832384f,
            -0.602750f, -1.873787f, -0.799235f, 1.035129f,  -0.149123f, -0.094288f, -0.476563f, -1.677109f,
            0.236771f,  0.248556f,  -0.267247f, -0.700641f, -0.796443f, -0.438229f, -0.399663f, -0.430412f,
            0.073627f,  0.897629f,  0.360583f,  1.936270f,  -1.503194f, 0.106475f,  -0.187268f, 0.543337f,
            -1.596197f, 1.196715f,  0.676051f,  1.008393f,  -1.084615f, -0.691895f, -0.890470f, 0.358055f,
            0.817841f,  0.248266f,  -0.050990f, 0.279140f,  -1.188511f, -0.292249f, 1.002352f,  -0.897211f,
            1.616615f,  -1.080666f, 0.276228f,  1.844064f,  0.487483f,  -2.236555f, 0.178645f,  -0.845019f,
            1.658841f,  -0.454903f, -0.059976f, -0.860774f, -0.574325f, 0.665028f,  -0.348634f, 0.171724f,
            -0.505944f, -0.053514f, -0.690907f, -0.638906f, 0.808752f,  -0.172525f, -1.267817f, -0.695311f,
            -1.208003f, 1.155050f,  -0.622963f, -0.176651f, 2.632745f,  1.341080f,  1.006037f,  -1.509527f,
            1.265869f,  2.068762f,  -0.814899f, -0.634920f, 0.376431f,  0.119990f,  -0.574990f, 0.000486f,
            0.002994f,  0.657566f,  -2.365031f, -0.538282f, 2.147738f,  -1.115724f, -0.574154f, 1.033483f,
            1.661359f,  0.506238f,  0.553486f,  -0.670954f, 0.696531f,  0.241556f,  1.424963f,  -0.138186f,
            0.241616f,  -0.885602f, -0.350500f, -1.015435f, 0.953171f,  -0.507068f, -0.052369f, -0.770391f,
            -0.495648f, 6.319518f,  -2.440750f, 2.196969f,  0.551760f,  -1.567822f, 1.470250f,  -0.393148f,
            1.192158f,  -2.575034f, 0.510679f,  -0.145381f, -1.640118f, -0.758671f, 1.129548f,  0.024315f,
            1.853917f,  -1.217933f, 0.449360f,  0.612330f,  -1.519804f, -0.360668f, 0.382162f,  -0.140149f,
            0.647628f,  0.680373f,  -1.136020f, 0.575621f,  0.456468f,  0.212960f,  -1.244019f, 1.243737f,
            -0.217254f, -0.590189f, 0.964545f,  -1.537347f, 0.747009f,  1.908738f,  -0.840716f, 0.913851f,
            0.548358f,  -0.287264f, 0.658662f,  0.359624f,  0.771492f,  0.661067f,  3.079612f,  -0.901561f,
            -0.710786f, -0.473187f, -1.046883f, -0.278782f, -0.463027f, 0.133926f,  -0.267452f, -0.821928f,
            0.265715f,  -1.176959f, 0.213038f,  1.228845f,  1.530784f,  0.578868f,  0.626686f,  -0.161063f,
            0.288249f,  -0.349529f, -0.293972f, -0.940843f, -0.929025f, 0.959726f,  0.907141f,  1.694362f,
            -0.005395f, -0.158689f, -0.696913f, -1.548518f, -0.793884f, 0.268772f,  0.587041f,  0.611830f,
            -1.754786f, 0.606877f,  -0.366665f, -0.857041f, 1.156384f,  -0.315192f, 0.581615f, -0.755387f,
        };

        [Test]
        public void TestEncode() {
            string path = Path.Combine("text_encoder", "model");
            var model = Resources.Load<ModelAsset>(path);
            if (model == null) {
                throw new FileNotFoundException($"The model filed for the text encoder was not found at: '{path}'");
            }

            ClipTokenizer tokenizer = new ClipTokenizer(Vocab, Merges);

            string prompt = "a cat";
            List<int> inputIds = tokenizer.Encode(
                prompt,
                padding: Padding.MaxLength,
                maxLength: tokenizer.ModelMaxLength,
                truncation: Truncation.LongestFirst
            ).InputIds;

            Debug.Log(string.Join(", ", inputIds));

            using (TensorInt tokens = new TensorInt(new TensorShape(1, inputIds.Count), inputIds.ToArray())) {
                TextEncoder textEncoder = new TextEncoder(model);
                TensorFloat output = textEncoder.ExecuteModel(tokens);
                output.MakeReadable();
                float[] promptEmbeds = output.ToReadOnlyArray();

                Debug.Log(expectedEmbedding.Length);
                Debug.Log(string.Join(", ", promptEmbeds));
                Assert.AreEqual(expectedEmbedding.Length, promptEmbeds.Length);

                //Assert.That(promptEmbeds, Is.EqualTo(expectedEmbedding).Within(0.0001f));
                CollectionAssert.AreEqual(expectedEmbedding, promptEmbeds, new FloatArrayComparer(0.0001f));
            }
        }
    }
}